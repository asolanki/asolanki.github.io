<div class="intro">
  {{ $cdn_url := .Scratch.Get "cdn_url" }}
  {{ $defaultPage := .Site.Params.defaultPage }} <!-- Store defaultPage in a variable -->
  {{ with .Site.Params.avatar}}
  {{ $avatar := .}}
 <div class="avatar">
      <a href="{{ $defaultPage }}"> <!-- Use the stored variable here -->
          <img src="{{ (printf "%s%s" $cdn_url $avatar)}}">
      </a>
  </div>
  {{ end }}
  {{ if or .Params.gravatar.Email (and .Site.Params.gravatar.Email (ne .Params.gravatar.Email false)) }}
  <div class="avatar">
          <a href="{{ $defaultPage }}"> <!-- And here -->
              <img src="https://www.gravatar.com/avatar/{{ md5 .Site.Params.gravatar.email }}?s=240&d=mp" alt="gravatar">
          </a>
  </div>
  {{ end }}
  {{ with .Site.Params.subtitle}}
  <h2 class="description">
     {{ . }}
  </h2>
  {{ end }}
  <div class="social-links">
    {{ partial "social.html" . }}
  </div>
</div>
